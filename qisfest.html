<!DOCTYPE html>
<html>
<head>
<title>QIS COLLEGE Fest 
    food Ordering</title>
<style>
body{font-family:Arial;text-align:center;background:#f4f4f4}
button{padding:8px;background:#ff5722;color:white;border:none}
.card{background:white;margin:10px;padding:10px}
.hidden{display:none}
</style>
</head>
<body>

<h1>ğŸ´ QIS College Fest</h1>

<div id="login">
<input id="name" placeholder="Name"><br><br>
<input id="phone" placeholder="Phone"><br><br>
<button onclick="login()">Login</button>
</div>

<div id="panel" class="hidden">

<h3>Welcome, <span id="cname"></span></h3>

<select id="stall" onchange="loadMenu()">
<option value="">Select Stall</option>
<option>Veg Meals</option>
<option>Non Veg Meals</option>
<option>Biryani</option>
<option>Ice Cream</option>
<option>Drinks</option>
<option>Starters</option>
</select>

<div id="menu"></div>

<h3>Cart</h3>
<div id="cart"></div>
<button onclick="placeOrder()">Place Order</button>

<h2>ğŸ“œ Your Orders</h2>
<div id="orders"></div>

</div>

<script>
let cart=[];

const stallInfo={
"Veg Meals":{prep:15,loc:"Block A"},
"Non Veg Meals":{prep:20,loc:"Block B"},
"Biryani":{prep:25,loc:"Block C"},
"Ice Cream":{prep:5,loc:"Block D"},
"Drinks":{prep:5,loc:"Block E"},
"Starters":{prep:10,loc:"Block F"}
};

const menus={
"Veg Meals":[{name:"Veg Thali",price:80},{name:"Curd Rice",price:40},{name:"Rice,paneer curry",price:70},{name:"Rice,melmaker",price:70},{name:"Rice,sambar",price:50}],
"Non Veg Meals":[{name:"Chicken rice",price:120},{name:"Egg Rice",price:70},{name:"Fishfry",price:120},{name:"Prawns rice",price:100},{name:"Chicken fry",price:90}],
"Biryani":[{name:"Chicken Biryani",price:150},{name:"Veg Biryani",price:100},{name:"Egg Biryani",price:110},{name:"Dum Biryani",price:150},{name:"Paneer Biryani",price:130}],
"Ice Cream":[{name:"Vanilla",price:30},{name:"Chocolate",price:40},{name:"Butterscotch",price:50},{name:"strawberry",price:60},{name:"Mango",price:40}],
"Drinks":[{name:"Lime Soda",price:25},{name:"Pepsi",price:30},{name:"Blueberry mojito",price:70},{name:"Classic mint mojito",price:80},{name:"Watermelon mojito",price:80}],
"Starters":[{name:"Gobi",price:60},{name:"Chicken 65",price:90},{name:"Crispy corn",price:80},{name:"Paneer 65",price:60},{name:"Veg roll",price:80}]
};

function login(){
let cust={name:name.value,phone:phone.value};
localStorage.setItem("customer",JSON.stringify(cust));
cname.innerText=cust.name;
loginDiv=document.getElementById("login");
loginDiv.classList.add("hidden");
panel.classList.remove("hidden");
showOrders();
}

function loadMenu(){
cart=[];
menu.innerHTML="";
menus[stall.value].forEach(i=>{
menu.innerHTML+=`<p>${i.name} â‚¹${i.price}
<button onclick="add('${i.name}',${i.price})">Add</button></p>`;
});
}

function add(n,p){
cart.push({name:n,price:p});
cartDiv=document.getElementById("cart");
cartDiv.innerHTML="";
cart.forEach(i=>cartDiv.innerHTML+=`<p>${i.name}</p>`);
}

function placeOrder(){
let cust=JSON.parse(localStorage.getItem("customer"));
let token=Math.floor(100+Math.random()*900);
let now=new Date();
let pickup=new Date(now.getTime()+stallInfo[stall.value].prep*60000);
let order = {
  token: token,
  name: cust.name,
  phone: cust.phone,
  stall: stall.value,
  items: cart,
  location: stallInfo[stall.value].loc,
  pickupTime: pickup.toLocaleTimeString(),
  status: "Preparing"   // â­ THIS LINE FIXES "undefined"
};


let orders=JSON.parse(localStorage.getItem("orders")||"[]");
orders.push(order);
localStorage.setItem("orders",JSON.stringify(orders));

cart=[];
menu.innerHTML="";
cartDiv.innerHTML="";
showOrders();
}

function showOrders(){
let cust=JSON.parse(localStorage.getItem("customer"));
let orders=JSON.parse(localStorage.getItem("orders")||"[]");
ordersDiv=document.getElementById("orders");
ordersDiv.innerHTML="";

orders.filter(o=>o.phone===cust.phone).forEach(o=>{
ordersDiv.innerHTML+=`
<div class="card">
ğŸŸ <b>Token:</b> ${o.token}<br>
ğŸ´ <b>Stall:</b> ${o.stall}<br>
ğŸ“ ${o.location}<br>
ğŸ§¾ ${o.items.map(i=>i.name).join(", ")}<br>
â° Pickup: ${o.pickupTime}<br>
<b>Status:</b> ${o.status}
</div>`;
});
}

setInterval(showOrders,3000);
</script>
</body>
</html>
